<!--
 * @Author: wxfeiang
 * @Description: 
 * @Date: 2023-05-03 18:35:12
 * @LastEditTime: 2023-07-27 10:45:47
 * @FilePath: /js/echarts/bar3.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bar</title>
</head>
<style>
    .main {
        width: 500px;
        height: 400px;
        margin: 0 auto;
        border: 1px solid #ccc;
    }
</style>

<body>
    <div class="" id="app">

        <div class="main" id="main"></div>
    </div>



</body>
<script src="https://cdn.bootcdn.net/ajax/libs/vue/2.6.13/vue.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.2/echarts.common.js"></script>
<script>
    new Vue({
        el: '#app',
        data() {
            return {
                myChart: null,
                timeOut: null,
                allData: [],
                startValue: 0,
                endValue: 4


            }
        },
        mounted() {

            this.init()
            this.autoMove()

        },
        methods: {
            init() {
                if (this.myChart) {
                    this.myChart.dispose()
                    this.myChart = null
                }
                this.myChart = echarts.init(document.getElementById('main'));

                let colorList = [
                    "#f36c6c",
                    "#e6cf4e",
                    "#20d180",
                    "#0093ff",
                    "#f36c6c",
                    "#e6cf4e",
                    "#20d180",
                    "#0093ff"
                ];

                this.allData = [
                    {
                        name: "æ­å·å¸‚",
                        count: 100,
                        percent: 0.182
                    },
                    {
                        name: "å®æ³¢å¸‚",
                        count: 366,

                        percent: 0.22
                    },

                    {
                        name: "æ¸©å·å¸‚",

                        count: 733,

                        percent: 0.452
                    },

                    {
                        name: "æ¹–å·å¸‚",

                        count: 287,

                        percent: 0.229
                    },

                    {
                        name: "ä¸½æ°´å¸‚",

                        count: 89,

                        percent: 0.082
                    },

                    {
                        name: "èˆŸå±±å¸‚",

                        count: 25,

                        percent: 0.112
                    },
                    {
                        name: "ä¸½æ°´å¸‚2",

                        count: 89,

                        percent: 0.082
                    },

                    {
                        name: "èˆŸå±±å¸‚2",

                        count: 25,

                        percent: 0.112
                    }
                ];
                let option = {
                    tooltip: {
                        trigger: "axis",
                        axisPointer: {
                            type: "shadow"
                        }
                    },

                    legend: {
                        show: false
                    },

                    // åŠ è¿™å—åœ°æ–¹é‡ç‚¹ï¼ï¼ï¼ï¼ï¼ï¼ï¼
                    dataZoom: [
                        //æ»‘åŠ¨æ¡
                        {
                            yAxisIndex: 0, //è¿™é‡Œæ˜¯ä»Xè½´çš„0åˆ»åº¦å¼€å§‹
                            show: false, //æ˜¯å¦æ˜¾ç¤ºæ»‘åŠ¨æ¡ï¼Œä¸å½±å“ä½¿ç”¨
                            type: "slider", // è¿™ä¸ª dataZoom ç»„ä»¶æ˜¯ slider å‹ dataZoom ç»„ä»¶
                            startValue: this.startValue, // ä»å¤´å¼€å§‹ã€‚
                            endValue: this.endValue, // ä¸€æ¬¡æ€§å±•ç¤º5ä¸ªã€‚
                        },
                    ],
                    xAxis: {
                        type: "value",

                        splitLine: {
                            show: false
                        },

                        axisLabel: {
                            show: false
                        },

                        axisTick: {
                            show: false
                        },

                        axisLine: {
                            show: false
                        }
                    },

                    yAxis: [
                        {
                            type: "category",

                            inverse: true,

                            axisLine: {
                                show: false
                            },

                            axisTick: {
                                show: false
                            },

                            axisPointer: {
                                label: {
                                    show: true
                                }
                            },

                            data: this.allData.map(item => item.name),

                            axisLabel: {
                                margin: 20,

                                fontSize: 14,

                                color: "#333"
                            }
                        },

                        {
                            type: "category",

                            inverse: true,

                            axisTick: "none",

                            axisLine: "none",
                            offset: -10,
                            zlevel: 100,
                            show: true,
                            position: "left",
                            axisLabel: {
                                textStyle: {
                                    color: "#000",
                                    // fontSize: "10"
                                    align: 'left'
                                }
                            },
                            data: this.allData.map(item => item.count)
                        }
                    ],
                    series: [
                        {
                            z: 2,
                            name: "value",
                            type: "bar",
                            align: "left",
                            //   barCategoryGap: '50%',
                            data: this.allData
                                .map(item => item.percent)
                                .map((item, i) => {
                                    itemStyle = {
                                        color: colorList[i]
                                    };
                                    return {
                                        value: item,
                                        itemStyle: itemStyle
                                    };
                                }),
                            label: {
                                normal: {
                                    show: true,
                                    position: "right",
                                    color: "#333333",
                                    fontSize: 14,
                                    formatter: function (value) {
                                        let val = (value && value.data && value.data.value) || 0;
                                        return parseFloat(val * 100).toFixed(2) + "%";
                                    }
                                }
                            }
                        }
                    ]
                };

                this.myChart.setOption(option)
            },
            autoMove() {
                // let option = this.myChart.getOption()
                // console.log(option)
                // è‡ªåŠ¨æ»šåŠ¨ï¼š
                this.timeOut = setInterval(() => {
                    if (this.endValue == this.allData.length) {
                        this.endValue = 4;
                        this.startValue = 0;
                    } else {
                        this.endValue += 1;
                        this.startValue += 1;
                    }
                    let dataZoom = [
                        {
                            yAxisIndex: 0, //è¿™é‡Œæ˜¯ä»Xè½´çš„0åˆ»åº¦å¼€å§‹
                            show: false, //æ˜¯å¦æ˜¾ç¤ºæ»‘åŠ¨æ¡ï¼Œä¸å½±å“ä½¿ç”¨
                            type: "slider", // è¿™ä¸ª dataZoom ç»„ä»¶æ˜¯ slider å‹ dataZoom ç»„ä»¶
                            startValue: this.startValue, // ä»å¤´å¼€å§‹ã€‚
                            endValue: this.endValue, // ä¸€æ¬¡æ€§å±•ç¤º5ä¸ªã€‚
                        },
                    ]
                    // console.log('ğŸ¥©[option]:', dataZoom);
                    this.init()
                    this.myChart.on('mouseover', this.stop())
                    this.myChart.on('mouseout', this.goMove())
                }, 2000)
            },
            //åœæ­¢æ»šåŠ¨
            stop() {
                clearInterval(this.timeOut)
            },
            //ç»§ç»­æ»šåŠ¨
            goMove() {
                this.autoMove()
            }
        }


    })




</script>

</html>